<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Add Book</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100">
    <!-- Include Header -->
    <%- include('../header') %>
        <div class="flex">
            <!-- Include Sidebar -->
            <%- include('../sidebar') %>

                <!-- Main Content -->
                <div class="ml-64 flex-1 p-8">
                    <!-- Form Container -->
                    <div class="max-w-3xl mx-auto bg-white rounded-lg shadow-md p-6">
                        <h2 class="text-2xl font-bold mb-6 text-gray-800">Add New Book</h2>

                        <form action="/admin/addBook" method="POST" enctype="multipart/form-data" class="space-y-6">
                            <!-- Category -->
                            <div>
                                <label for="categoryId" class="block text-sm font-medium text-gray-700">Category</label>
                                <select id="categoryId" name="categoryId" required
                                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500">
                                    <option value="" disabled selected>Select a category</option>
                                    <% categories.forEach(category=> { %>
                                        <option value="<%= category._id %>">
                                            <%= category.categoryName %>
                                        </option>
                                        <% }); %>
                                </select>
                            </div>

                            <!-- Subcategory -->
                            <div class="form-group row">
                                <label for="fname" class="col-sm-3 text-right control-label col-form-label">SubCategory
                                    Name</label>
                                <div class="col-sm-9">
                                    <select id="subCategoryId" name="subCategoryId">
                                        <option value="">------ Select Sub Category ------</option>
                                    </select>
                                </div>
                            </div>

                            <!-- Book Title -->
                            <div>
                                <label for="bookTitle" class="block text-sm font-medium text-gray-700">Book
                                    Title</label>
                                <input type="text" id="bookTitle" name="bookTitle" required
                                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500">
                            </div>

                            <!-- Book Description -->
                            <div>
                                <label for="bookDescription" class="block text-sm font-medium text-gray-700">Book
                                    Description</label>
                                <textarea id="bookDescription" name="bookDescription" rows="3" required
                                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500"></textarea>
                            </div>

                            <!-- Book Image -->
                            <div>
                                <label for="bookImage" class="block text-sm font-medium text-gray-700">Book
                                    Image</label>
                                <input type="file" id="bookImage" name="bookImage" accept="image/*" required
                                    class="mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:text-sm file:font-semibold file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100">
                            </div>

                            <!-- Book Pages -->
                            <div>
                                <label for="bookPages" class="block text-sm font-medium text-gray-700">Number of
                                    Pages</label>
                                <input type="number" id="bookPages" name="bookPages" required
                                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500">
                            </div>

                            <!-- Book Price -->
                            <div>
                                <label for="bookPrice" class="block text-sm font-medium text-gray-700">Price</label>
                                <input type="number" step="0.01" id="bookPrice" name="bookPrice" required
                                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500">
                            </div>


                            <!-- Book Author -->
                            <div>
                                <label for="bookAuthor" class="block text-sm font-medium text-gray-700">Author</label>
                                <input type="text" id="bookAuthor" name="bookAuthor" required
                                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500">
                            </div>

                            <!-- Published Date -->
                            <div>
                                <label for="bookPublishedDate" class="block text-sm font-medium text-gray-700">Published
                                    Date</label>
                                <input type="date" id="bookPublishedDate" name="bookPublishedDate" required
                                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500">
                            </div>

                            <!-- Book Language -->
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Book Language</label>
                                <div class="flex flex-wrap space-x-4">
                                    <label class="inline-flex items-center">
                                        <input type="checkbox" name="bookLanguage" value="Hindi" class="form-checkbox text-indigo-600">
                                        <span class="ml-2">Hindi</span>
                                    </label>
                                    <label class="inline-flex items-center">
                                        <input type="checkbox" name="bookLanguage" value="English" class="form-checkbox text-indigo-600">
                                        <span class="ml-2">English</span>
                                    </label>
                                    <label class="inline-flex items-center">
                                        <input type="checkbox" name="bookLanguage" value="Gujarati" class="form-checkbox text-indigo-600">
                                        <span class="ml-2">Gujarati</span>
                                    </label>
                                    <label class="inline-flex items-center">
                                        <input type="checkbox" name="bookLanguage" value="Marathi" class="form-checkbox text-indigo-600">
                                        <span class="ml-2">Marathi</span>
                                    </label>
                                    <label class="inline-flex items-center">
                                        <input type="checkbox" name="bookLanguage" value="Tamil" class="form-checkbox text-indigo-600">
                                        <span class="ml-2">Tamil</span>
                                    </label>
                                    <label class="inline-flex items-center">
                                        <input type="checkbox" name="bookLanguage" value="Telugu" class="form-checkbox text-indigo-600">
                                        <span class="ml-2">Telugu</span>
                                    </label>
                                    <label class="inline-flex items-center">
                                        <input type="checkbox" name="bookLanguage" value="Malayalam" class="form-checkbox text-indigo-600">
                                        <span class="ml-2">Malayalam</span>
                                    </label>
                                    <label class="inline-flex items-center">
                                        <input type="checkbox" name="bookLanguage" value="Kannada" class="form-checkbox text-indigo-600">
                                        <span class="ml-2">Kannada</span>
                                    </label>
                                </div>
                            </div>

                            <!-- Stock -->
                           

                            <!-- Submit Button -->
                            <div class="flex justify-end">
                                <button type="submit"
                                    class="bg-indigo-600 text-white px-4 py-2 rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2">
                                    Add Book
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
        </div>


        <script>
            document.addEventListener("DOMContentLoaded", function () {
                const categorySelect = document.getElementById('categoryId');
                // console.log(categorySelect);
                const subCategorySelect = document.getElementById('subCategoryId');
                categorySelect.addEventListener("change", function () {
                    let categoryId = categorySelect.value;
                    console.log(categoryId);
                    subCategorySelect.innerHTML = `<option>----- Select Sub Category -----</option>`
                    // fetch(`/extraCategory/getsubcategoies?categoryId=${categoryId}`)
                    fetch(`/admin/getsubcategories/${categoryId}`)
                        .then((res) => res.json())
                        .then((data) => {
                            // console.log(data);
                            if (data.subCategories && data.subCategories.length > 0) {
                                data.subCategories.forEach(subCategory => {
                                    let option = document.createElement("option");
                                    option.value = `${subCategory._id}`
                                    option.textContent = `${subCategory.subCategoryName}`
                                    subCategorySelect.appendChild(option)
                                });
                            } else {
                                let option = document.createElement("option");
                                option.value = ""
                                option.textContent = "No Sub Category Found"
                                subCategorySelect.appendChild(option)
                            }
                        })
                })
            })
        </script>
</body>

</html>